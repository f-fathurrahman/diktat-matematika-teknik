\input{PREAMBLE}

% -------------------------
\begin{document}

\title{%
{\small TF2201 Matematika Rekayasa II}\\
Variabel Kompleks: Fungsi Elementer
}
\author{Fadjar Fathurrahman\\
Teknik Fisika\\
Institut Teknologi Bandung}
\date{2023}
\maketitle

Pada catatan kuliah ini kita akan mempelajari beberapa fungsi dari
variabel kompleks.


\section{Fungsi polinomial dan fungsi rasional}
Polinomial $P_n(z)$ dengan derajat $n$ dari suatu variabel kompleks $z$ dapat
dituliskan sebagai:
\begin{equation}
P_{n}(z) = a_{n}z^{n} + a_{n-1}z^{n-1} + \cdots + a_{1}z + a_{0}
\end{equation}
dengan koefisien $a_{n},a_{n-1},\ldots,a_{1},a_{0}$ adalah bilangan
kompleks dan $n$ adalah bilangan bulat positif.

Fungsi rasional $Q(z)$, atau hasil bagi antara dua polinomial:
\begin{equation}
Q(z) = \frac{a_{n}z^{n} + a_{n-1}z^{n-1} + \cdots + a_{1}z + a_{0}}%
{b_{m}z^{m}+b_{m-1}z^{m-1}+\cdots+b_{1}z+b_{0}}
\end{equation}
Suku penyebut dari $Q(z)$ diasumsikan memiliki derajat $\geq 1$ sehingga
$Q(z)$ tidak tereduksi menjadi polinomial.


\section{Fungsi eksponensial dan trigonometrik}

Selanjutnya kita akan meninjau fungsi $f(z$) yang dinyatakan
sebagai suatu deret pangkat:
\begin{equation}
f(z) = \sum_{n=0}^{\infty} a_{n} z^{n}
\label{eq:fz-deret-pangkat}
\end{equation}
di mana deret diasumsikan konvergen untuk semua $z$, $|z|<R$, dan
$R>0$. Jika
\begin{equation*}
\lim_{n\rightarrow\infty}\left|\frac{a_{n+1}}{a_{n}}\right|=\frac{1}{R}
\end{equation*}
ada, maka deret \ref{eq:fz-deret-pangkat}
konvergen untuk semua $z$ dalam $|z| < R$, dan divergen untuk semua $z$
jika $|z| > R$.

Fungsi eksponensial $f(z) = e^{z}$ dapat didefinisikan sebagai
deret pangkat:
\begin{equation}
e^{z} = 1 + z + \frac{z^{2}}{2!} + \frac{z^{3}}{3!} + \cdots
\end{equation}
%
Fungsi $f(z) = \sin(z)$ dan $f(z) = \cos(z)$ juga didefinisikan
sebagai deret pangkat:
\begin{align*}
\sin(z) = z - \frac{z^{3}}{3!} + \frac{z^{5}}{5!} - \cdots \\
\cos(z) = 1 - \frac{z^{2}}{2!} + \frac{z^{4}}{4!} - \cdots
\end{align*}
Definisi tersebut dipilih agar sama dengan ekspansi deret Taylor standard
untuk $e^{x}$, $\sin(x)$, dan $\cos(x)$ ketika $y=0$ (bagian imajiner
bernilai 0).

Dari formula-formula tersebut dapat diperoleh
\begin{align}
\sin(z) = \frac{e^{\imath z}-e^{-\imath z}}{2\imath } \\
\cos(z) = \frac{e^{\imath z}+e^{-\imath z}}{2}
\end{align}

Untuk $z = \mathrm{i\theta}$ dapat diperoleh
\begin{align*}
e^{\imath \theta} & = 1 + (\imath \theta) +
  \frac{(\imath \theta)^{2}}{2!} +
  \frac{(\imath \theta)^{3}}{3!} +
  \frac{(\imath \theta)^{4}}{4!} +
  \frac{(\imath \theta)^{5}}{5!} + \cdots \\
 & = 1 + \imath \theta - \frac{\theta^{2}}{2!} - \imath \frac{\theta^{3}}{3!} +
     \frac{\theta^{4}}{4!} + \imath \frac{\theta^{5}}{5!} + \cdots \\
 & = \left(1-\frac{\theta^{2}}{2!}+\frac{\theta^{4}}{4!}-\cdots\right) + \imath \left(\theta-\frac{\theta^{3}}{3!}+\frac{\theta^{5}}{5!}-\cdots\right)\\
 & = \cos(\theta) + \imath  \sin(\theta)
\end{align*}

Hubungan ini berguna untuk menuliskan bentuk polar bilangan kompleks
$z=r(\cos\theta+\imath \sin\theta)$ menjadi
\begin{equation}
z = r e^{\imath \theta}
\end{equation}

Fungsi sinus hiperbolik dan kosinus hiperbolik didefinisikan sebagai
\begin{align}
\sinh(z) & = \frac{e^{z} - e^{-z}}{2} \\
\cosh(z) & = \frac{e^{z} + e^{-z}}{2}
\end{align}
Hubungan berikut ini dapat diturunkan:
\begin{align}
\sinh(\imath z) & = \imath  \sin(z) \\
\cosh(\imath z) & = \cos(z) \\
\sin(\imath z) & = \imath \sinh(z) \\
\cos(\imath z) & = \cosh(z)
\end{align}

Dengan memisahkan antara bagian real dan imajiner dari $\sin(z)$ dan
$\cos z$
\begin{align*}
\sin(z) & =\sin\left(x + \imath y\right) \\
 & = \sin(x) \cos(\imath y) + \sin(\imath y) \cos(x) \\
 & = \sin(x) \cosh(y) + \imath \sin(y)\cos(x)
\end{align*}
dan
\begin{align*}
\cos(z) & = \cos(x + \imath y) \\
 & = \cos(x)\cos(\imath y) - \sin(x) \sin(\imath y) \\
 & = \cos(x)\cosh(y) - \imath \sinh(x) \sinh(y)
\end{align*}



\section{Fungsi logaritma}

Logaritma alami (natural logarithm) dari bilangan kompleks $z$, ditulis
sebagai $\ln z$ harus didefinisikan sehingga
\[
e^{\ln z}=z
\]
Dengan menggunakan bentuk polar dari $z$ diperoleh:
\begin{equation}
\ln(z) = \ln \left(r e^{\imath \theta} \right)
\end{equation}
atau:
\begin{equation}
\ln(z) = \ln(r) + \imath \theta = \ln(r) + \imath\left[\theta + 2\pi k \right]
\label{eq:log-natural}
\end{equation}
untuk bilangan bulat $k$.
Bentuk ini adalah kandidat untuk definisi dari $\ln(z)$. Konsekuensi
dari definisi ini adalah
\begin{align*}
e^{\ln z} & =e^{\ln(r) + \imath \theta}\\
 & = e^{\ln r}e^{\imath \theta}\\
 & = r\left(\cos\theta+\imath \sin\theta\right)\\
 & = z
\end{align*}
sehingga definisi ini memenuhi syarat untuk $\ln z$.

Perhatikan bahwa karena $\theta$ dapat bernilai lebih dari satu karena
$e^{\mathrm{i\theta}} = e^{\imath (\theta + 2\pi k)}$ dengan $k=0,1,2,\ldots$,
kita harus memberikan batasan untuk $\theta$ sehingga $\ln z$
menjadi $\ln x$ ketika $y=0$. Batasan ini adalah $0\leq\theta<2\pi$
atau $-\pi < \theta \leq \pi$. Batasan ini memberikan \textbf{nilai prinsipal}
atau \textbf{nilai pokok} dari $\ln(z)$.


\section{Fungsi pangkat}

Untuk fungsi pangkat $z^{a}$ dengan $z$ dan $a$ adalah bilangan
kompleks. Dari definisi
\begin{equation}
z^{a} = e^{a\ln z}
\label{eq:pangkat-kompleks}
\end{equation}
Definisi ini sama dengan definisi dari $z^{a}$ jika eksponen adalah
bilangan rasional atau bilangan bulat.



\section{Fungsi trigonometrik invers}

Misalkan
\begin{equation*}
w = \sin^{-1}(z)
\end{equation*}
atau
\begin{align*}
z & = \sin(w) = \frac{e^{\imath w} - e^{-\imath  w}}{2\imath} \\
2\imath z & = e^{\imath w}-e^{-\imath w}
\end{align*}
Dengan mengalikan kedua ruas persamaan dengan $e^{\imath w}$ diperoleh
\begin{equation*}
e^{2\imath w} - 2 \imath ze^{\imath w} - 1 = 0
\end{equation*}
Dengan menuliskan $e^{\imath w} \rightarrow \phi$ diperoleh persamaan
kuadrat dalam $\phi$:
\begin{equation*}
\phi^{2} - 2\imath z\phi - 1 = 0
\end{equation*}
yang memiliki solusi:
\begin{align*}
e^{\imath w} & = \phi = \frac{-(-2\imath z)+\left((-2\imath z)(-2\imath z)-4(1)(-1)\right)^{1/2}}{2(1)}\\
 & =\frac{-(-2\imath z)+\left( -4z^{2} + 4 \right)^{1/2}}{2(1)}\\
 & =\imath z+\left(1-z^{2}\right)^{1/2}
\end{align*}

Diperoleh ekspresi untuk $\imath w$ sebagai berikut:
\begin{equation*}
\imath w=\ln\left[\imath z+\left(1-z^{2}\right)^{1/2}\right]
\end{equation*}
dan untuk $w = \sin^{-1}(z)$ sebagai berikut:
\begin{equation}
w = \sin^{-1}z = -\imath \ln\left[\imath z + \left(1 - z^{2}\right)^{1/2}\right]
\end{equation}
Ekspresi ini memiliki nilai ganda akibat tanda akar kuadrat
(pangkat $1/2$) dan multinilai karena fungsi logaritma natural. Dua nilai
prinsipal dihasilkan untuk tiap bilangan kompleks $z$ kecuali untuk
$z=1$ karena tanda pada akar kuadrat akan bernilai 0.

Dengan cara yang mirip dapat diperoleh definisi sebagai berikut
\begin{align}
\sin^{-1}(z) & = -\imath \ln\left[\imath z+\left(1-z^{2}\right)^{1/2}\right] \label{eq:inv-sin-z}\\
\cos^{-1}(z) & = -\imath \ln\left[z+\left(z^{2}-1\right)^{1/2}\right] \\
\tan^{-1}(z) & = \frac{\imath }{2}\ln\frac{1-\imath z}{1+\imath z} \\
\sinh^{-1}(z) & = \ln\left[z + \left(1+z^{2} \right)^{1/2}\right] \\
\cosh^{-1}(z) & = \ln\left[z + \left(z^{2} - 1\right)^{1/2}\right] \\
\tanh^{-1}(z) & = \frac{1}{2} \ln\left( \frac{1+z}{1-z} \right)
\end{align}


\section{Contoh soal}

\begin{contoh}
Hitung nilai pokok dari $\imath^{\imath}$

Dengan menggunakan Persamaan \eqref{eq:pangkat-kompleks} diperoleh
\begin{equation*}
\imath^{\imath} = e^{\imath \ln(\imath)}
\end{equation*}
Untuk fungsi logaritma natural kita dapat menggunakan Persamaan \ref{eq:log-natural}.
Ubah bentuk $z=\imath$ menjadi bentuk polar $z = r e^{\imath \theta}$ diperoleh
$r = 1$ dan $\theta = \pi/2$:
\begin{equation*}
\ln(\imath) = \ln(1) + \imath (\pi/2)
\end{equation*}
Sehingga diperoleh:
\begin{align*}
\imath^{\imath} & = e^{\imath\left[ \ln(1) + \imath (\pi/2) \right]} \\
& = e^{\imath\left[ \imath (\pi/2) \right]} \\
& = e^{-\pi/2}
\end{align*}

\end{contoh}

Merujuk pada soal sebelumnya, kita juga dapat melakukan
perbandingan hasil perhitungan dengan menggunakan Python.
\begin{pyconcode}
>>> 1j**1j
(0.20787957635076193+0j)
>>> import math, cmath
>>> math.exp(-math.pi/2)
0.20787957635076193
>>> cmath.exp(-cmath.pi/2)
(0.20787957635076193+0j)
\end{pyconcode}
Perhatikan bahwa modul \pyinline{cmath} juga dapat digunakan. Untuk perhitungan
fungsi eksponensial dengan argumen variabel kompleks modul \pyinline{cmath}
perlu digunakan.


\begin{contoh}
Hitung nilai pokok dari:
\begin{equation*}
(2 + \imath)^{1 - \imath}
\end{equation*}
Dengan menggunakan Persamaan \eqref{eq:pangkat-kompleks}:
\begin{equation}
(2 + \imath)^{1 - \imath} = e^{(1-\imath) \ln(2 + \imath)}
\end{equation}
Ubah $z = 2 + \imath$ dalam bentuk polar $z = r e^{\imath \theta}$
dengan $r = \sqrt{2^2 + 1} = \sqrt{5}$ dan
$\theta = \tan^{-1}(1/2) \approx 0.4636$ (dalam radian).
Maka diperoleh:
\begin{align*}
(2 + \imath)^{1 - \imath} & = e^{ (1-\imath)( \ln(\sqrt{5}) + 0.4636) } \\
& = e^{1.2683 - 0.3411\imath} \\
& = e^{1.2683} e^{-0.3411\imath} \\
& = e^{1.2683} \left( \cos(0.3411) - \imath \sin(0.3411) \right) \\
& = 3.350 - 1.189\imath
\end{align*}
\end{contoh}

\begin{pythoncode}
import cmath, math
# math: aritmatika dan fungsi real
# cmath: aritmatika dan fungsi kompleks

z1 = 2 + 1j
z2 = 1 - 1j
direct_pow = z1**z2 # using Python's built-in operator for power
print("direct_pow = ", direct_pow)

# representasi z1 dalam bentuk polar
r1 = math.sqrt(z1.real**2 + z1.imag**2)
θ1 = math.atan2(z1.imag, z1.real)
print("r1 = ", r1)
print("θ1 = ", θ1)

ln_z1 = math.log(r1) + 1j*θ1 # ln(z1), menggunakan aritmatika dan fungsi real
print("ln_z1 = ", ln_z1)

# Menggunakan fungsi kompleks
print("ln_z1 (using cmath): ", cmath.log(z1))

# (1 - i)*ln_z1
p1 = z2*ln_z1

# Hitung e^{x + iy} = e^x ( cos(y) + i*sin(y) )
# x: bagian real, y: bagian imajiner
res = math.exp(p1.real)*( math.cos(p1.imag) + 1j*math.sin(p1.imag) )
print("res = ", res)
\end{pythoncode}

Contoh keluaran:
\begin{textcode}
direct_pow =  (3.3502593150728757-1.1891502215003973j)
r1 =  2.23606797749979
θ1 =  0.4636476090008061
ln_z1 =  (0.8047189562170503+0.4636476090008061j)
ln_z1 (using cmath):  (0.8047189562170503+0.4636476090008061j)
res =  (3.350259315072876-1.1891502215003975j)
\end{textcode}



\begin{contoh}
Untuk $z = 3 - 4\imath$ hitung nilai atau nilai pokok dari (a) $e^{\imath z}$,
(b) $e^{-\imath z}$, (c) $\sin(z)$, dan (d) $\ln(z)$.

\begin{align*}
e^{\imath z} & = e^{\imath (3 - 4\imath)} \\
             & = e^{4 + 3\imath} \\
             & = e^{4} e^{3\imath} \\
             & = e^{4}(\cos(3) + \imath \sin(3)) \\
             & = -54.05 + 7.704\imath
\end{align*}

\begin{align*}
e^{-\imath z} & = e^{-\imath (3 - 4\imath)} \\
             & = e^{-4 - 3\imath} \\
             & = e^{-4} e^{-3\imath} \\
             & = e^{-4}(\cos(-3) + \imath \sin(-3)) \\
             & = -0.01814 - 0.002585\imath
\end{align*}


\begin{align*}
\sin(z) & = \frac{e^{\imath z} - e^{-\imath z}}{2\imath} \\
        & = 3.853 + 27.01\imath
\end{align*}


\begin{align*}
\ln(z) & = \ln(3 - 4\imath) \\
       & = \ln(5) + \imath \tan^{-1}\left(\frac{-4}{3}\right) \\
       & = 1.609 + 5.356\imath
\end{align*}

\end{contoh}

Perbandingan dengan menggunakan Python:
\begin{pythoncode}
import cmath

z = 3 - 4j
    
bag_a = cmath.exp(1j*z)
print("bag_a = ", bag_a)

bag_b = cmath.exp(-1j*z)
print("bag_b = ", bag_b)

bag_c = cmath.sin(z)
print("bag_c = ", bag_c)

bag_d = cmath.log(z)
print("bag_d = ", bag_d)    
\end{pythoncode}

Contoh keluaran:
\begin{textcode}
bag_a =  (-54.051758861078156+7.704891372731154j)
bag_b =  (-0.018132345070290157-0.002584703107599785j)
bag_c =  (3.853738037919377+27.016813258003936j)
bag_d =  (1.6094379124341003-0.9272952180016122j)
\end{textcode}


\begin{contoh}
Cari nilai $z$ yang memenuhi $\sin(z) = 10$.

Kita dapat menggunakan:
\begin{equation*}
\sin^{-1}(z) = -\imath \ln\left[\imath z+\left(1-z^{2}\right)^{1/2}\right]
\end{equation*}
Dengan menggunakan $z = 10$ diperoleh:
\begin{equation*}
z = \sin^{-1}(10) = -\imath \ln \left[ 10\imath + (-99)^{1/2} \right]
\end{equation*}
Dua akar dari $-99$ adalah $3\imath\sqrt{11}$ dan $-3\imath\sqrt{11}$ sehingga:
\begin{align*}
z_1 & = -\imath \ln\left[ (10 + 3\sqrt{11})\imath \right] \\
z_2 & = -\imath \ln\left[ (10 - 3\sqrt{11})\imath \right]
\end{align*}
Untuk $\alpha$ real (bagian imajiner adalah nol):
\begin{equation*}
\ln(\alpha \imath) = \ln(|\alpha|) + (\pi/2)\imath
\end{equation*}
sehingga diperoleh:
\begin{align*}
z_1 & = \frac{\pi}{2} - \imath \ln(10 + 3\sqrt{11}) = \frac{\pi}{2} - 2.993\imath \\
z_2 & = \frac{\pi}{2} - \imath \ln(10 - 3\sqrt{11}) = \frac{\pi}{2} + 2.993\imath
\end{align*}

\end{contoh}

Pada modul \pyinline{cmath} juga terdapat fungsi \pyinline{asin} untuk menghitung
invers fungsi sinus, akan tetapi fungsi ini hanya mengembalikan satu nilai:
\begin{pyconcode}
>>> cmath.asin(10)
(1.5707963267948966+2.993222846126381j)
\end{pyconcode}

Karena menghitung $\sin^{-1}(10)$ sama dengan mencari solusi $z$ dari persamaan
$\sin(z) = 10$ kita juga dapat menggunakan fungsi \pyinline{solve} dari SymPy
seperti pada kode berikut.
\begin{pythoncode}
from sympy import *

z = symbols("z")

# Hitung sin^{-1}(10) dengan cara menyelesaikan persamaan sin(z) = 10
res = solve(sin(z) - 10.0, z)
# 10.0: gunakan floating point

for r in res:
    print(N(r)) # ubah ke bentuk numerik
\end{pythoncode}

Contoh keluaran dari program di atas adalah sebagai berikut.
\begin{textcode}
1.5707963267949 - 2.99322284612638*I
1.5707963267949 + 2.99322284612638*I
\end{textcode}

Hal yang perlu diingat adalah fungsi \pyinline{solve} tidak menggunakan Persamaan
\eqref{eq:inv-sin-z} sehingga hasil yang diperoleh mungkin saja terlihat berbeda.
Sebagai alternatif, kita juga dapat mengimplementasikan sendiri fungsi-fungsi 
untuk variabel kompleks, misalnya untuk fungsi invers sinus dan kosinus
kompleks sebagai berikut.
\begin{pythoncode}
def my_arc_sin(z):
    r1 = 1j*z + cmath.sqrt(1 - z**2)
    r2 = 1j*z - cmath.sqrt(1 - z**2)
    return -1j*cmath.log(r1), -1j*cmath.log(r2)

def my_arc_cos(z):
    r1 = z + cmath.sqrt(z**2 - 1)
    r2 = z - cmath.sqrt(z**2 - 1)
    return -1j*cmath.log(r1), -1j*cmath.log(r2)
\end{pythoncode}


\end{document}
